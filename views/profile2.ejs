<%- include('partials/header') -%>

<section class="p-3 p-sm-4 p-lg-5">
  <div class="container-md">

    
    <!-- Return To feed & Logout button -->
    <div class="row justify-content-center mt-5">
      <a class="btn btn-primary w-25 mx-2" href="/feed">Return to Feed</a>
      <a href="/logout" class="col-3 btn btn-primary mx-2">Logout</a>
    </div> 

    <!-- User Info and Logout -->
    <div class="row justify-content-center mt-4 text-center text-light">
      <h2 class="text-center m-1 text-light">Welcome to your Profile!</h2>
      <p class="text-capitalize pt-2"><strong>User Name</strong>: <%= user.userName %></p>
          <p><strong>Email</strong>: <%= user.email %></p>
          <!-- <a href="/logout" class="col-3 btn btn-primary">Logout</a> -->
    </div>

    <!-- Create Post Button (opens modal) -->
    <div class="d-flex justify-content-center my-3">
      <button class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#enroll">Create Post</button>
    </div>
    

    <!-- "Your Posts" Container -->
    <div class="col g-4 align-items-center mt-5">
      <h2 class="text-center mt-3 mb-0 text-light">My Posts</h2>
      
      <!-- Conditional for counting posts -->
      <%if(posts.length > 0 ){ %>   
        <h4 class="text-center fst-italic mt-2 mb-0 text-light ">You have <%= posts.length %> Posts </h4>
        <%} else { %> 
        <h4 class="text-center fst-italic mt-2 mb-0 text-light">You have <%= posts.length %> Posts, share something! </h4>  
      <% } %>


      <!-- CARDS FOR POSTS -->
      <% for(var i=0; i<posts.length; i++) {%>
        <div class="m-4">
          <div class="card bg-light text-center border-primary border-3">

            <!-- Card Header -->
            <div class="card-header">
              <!-- Post Title -->
              <h2 class="card-title my-1 text-center"><%= posts[i].title %></h2>
              <!-- Date and Time  -->
              <span class="text-capitalize fst-italic mx-1 fs-5 card-subtitle"> <%= posts[i].createdAt.toLocaleDateString()%>, <%= posts[i].createdAt.toLocaleTimeString()%></span>
            </div>

            <div class="card-body text-dark py-1 ">
              <!-- Post Title -->
              <!-- <h2 class="card-title my-1 text-center"><%= posts[i].title %></h2> -->

              <!-- Date and Time  -->
              
              <!-- <span class="text-capitalize fst-italic mx-1 fs-5 card-subtitle"> <%= posts[i].createdAt.toLocaleDateString()%>, <%= posts[i].createdAt.toLocaleTimeString()%></span> -->

              <!-- Post Image -->
              <a href="/post/<%= posts[i]._id%>" class="d-flex justify-content-center">
                <img class="img-fluid" src="<%= posts[i].image%>">
              </a>

            </div>
            <!-- Card Footer -->
            <div class="card-footer">
              <!-- Container for date/time like & comment count, Delete -->
              <div class="d-flex justify-content-center text-center mt-2"> 
                <span class="text-capitalize fst-italic mx-1 fs-5 text-end ">&nbsp; <%= posts[i].createdAt.toLocaleDateString()%> @ <%= posts[i].createdAt.toLocaleTimeString()%></span>
  
                <span class="col fa fa-heart text-end fs-5">&nbsp; <%= posts[i].likes%></span>
  
                <span class="col fa fa-comment text-end fs-5">&nbsp; <%= posts[i].numOfComments%></span>
  
                <form action="/post/deletePost/<%= posts[i].id %>?_method=DELETE" method="POST" class="d-inline col"> 
                  <button class="btn btn-primary fa fa-trash" type="submit"></button>
                </form>
              </div> 

            </div>
          </div>
        </div>
        <% } %>
    </div>

    <!-- Return To Feed Button -->
    <div class="row justify-content-center mt-5">
      <a class="btn btn-primary w-25" href="/feed">Return to Feed</a>
    </div>
  </div>
</section>





<!-- MODAL FOR POST CREATION -->
<div class="modal fade" id="enroll" tabindex="-1" >
    <div class="modal-dialog">

      <div class="modal-content"> 
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Create Post</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        

        <div class="modal-body">

          <form action="/post/createPost" enctype="multipart/form-data" method="POST" class="" id="create-post"> <!---enctype is for multer to work-->
            <div class="mb-3">
              <label for="title" class="form-label">Title</label>
              <input type="text" class="form-control" id="title" name="title">
            </div>
  
            <div class="mb-3">
              <label for="caption" class="form-label">Caption</label>
              <textarea class="form-control" id="caption" name="caption"></textarea>
            </div>
  
            <div class="mb-3">
              <label for="imgUpload" class="form-label">Image</label>
              <input type="file" class="form-control" id="imageUpload" name="file">
            </div>
          </form>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

          <button type="submit" class="btn btn-primary" value="Upload" form="create-post">Submit</button>
        </div>

      </div>
    </div>
</div>





<%- include('partials/footer') -%>